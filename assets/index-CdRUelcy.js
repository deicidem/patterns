var O=Object.defineProperty;var H=(e,t,r)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var s=(e,t,r)=>(H(e,typeof t!="symbol"?t+"":t,r),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const m of n.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function r(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(a){if(a.ep)return;a.ep=!0;const n=r(a);fetch(a.href,n)}})();var I=(e=>(e[e.PENDING=1]="PENDING",e[e.PROCESSING=2]="PROCESSING",e[e.COMPLETED=3]="COMPLETED",e[e.CANCELLED=4]="CANCELLED",e))(I||{}),N=(e=>(e[e.STANDART=1]="STANDART",e[e.EXPRESS=2]="EXPRESS",e[e.PICKUP=3]="PICKUP",e))(N||{}),C=(e=>(e[e.PENDING=1]="PENDING",e[e.DELIVERING=2]="DELIVERING",e[e.DELIVERED=3]="DELIVERED",e))(C||{}),v=(e=>(e[e.PENDING=1]="PENDING",e[e.PAID=2]="PAID",e[e.ERROR=3]="ERROR",e))(v||{}),L=(e=>(e[e.CARD=1]="CARD",e[e.PAYPAL=2]="PAYPAL",e[e.QIWI=3]="QIWI",e))(L||{});class R{constructor(){this.id=0,this.createdAt=new Date,this.updatedAt=new Date,this.products=[],this.status=1,this.paymentMethod=null,this.deliveryAddress=null,this.deliveryMethod=null,this.deliveryCost=0,this.paymentStatus=null,this.deliveryStatus=null,this.deliveryDate=null}}class k{constructor(){s(this,"order");this.order=new R}withProducts(t){return this.order.products=t,this}withStatus(t){return this.order.status=t,this}withPaymentMethod(t){return this.order.paymentMethod=t,this}withDeliveryAddress(t){return this.order.deliveryAddress=t,this}withDeliveryMethod(t){return this.order.deliveryMethod=t,this}withDeliveryCost(t){return this.order.deliveryCost=t,this}withPaymentStatus(t){return this.order.paymentStatus=t,this}withDeliveryStatus(t){return this.order.deliveryStatus=t,this}withDeliveryDate(t){return this.order.deliveryDate=t,this}build(){return this.order}}const l=class l{constructor(){s(this,"idCounter");s(this,"items");this.idCounter=0,this.items=[]}static getInstance(){return this.instance==null&&(this.instance=new l),this.instance}incrementIdCounter(){this.idCounter++}getAll(){return this.items}getById(t){return this.items.find(r=>r.id==t)??null}create(t){return this.incrementIdCounter(),t.id=this.idCounter,this.items.push(t),t}update(t,r){let i=this.items.find(a=>a.id==t);if(i)i.createdAt=r.createdAt,i.updatedAt=r.updatedAt,i.products=r.products,i.status=r.status,i.paymentMethod=r.paymentMethod,i.deliveryAddress=r.deliveryAddress,i.deliveryMethod=r.deliveryMethod,i.deliveryCost=r.deliveryCost,i.paymentStatus=r.paymentStatus,i.deliveryStatus=r.deliveryStatus,i.deliveryDate=r.deliveryDate;else return null;return i}delete(t){this.items=this.items.filter(r=>r.id!=t)}};s(l,"instance",null);let u=l;class M{constructor(){s(this,"orderRepository");this.orderRepository=u.getInstance()}processOrder(t,r,i){let a=i.deliver(t);return this.orderRepository.update(t.id,{...t,deliveryCost:a.cost,deliveryStatus:C.PENDING,deliveryDate:a.date,status:I.PROCESSING}),r.processPayment(t)?(this.orderRepository.update(t.id,{...t,paymentStatus:v.PAID}),!0):!1}}var c=(e=>(e[e.PHONE=0]="PHONE",e[e.LAPTOP=1]="LAPTOP",e[e.HEADPHONES=2]="HEADPHONES",e))(c||{});class G{constructor(t,r,i){s(this,"type");s(this,"id");s(this,"name");s(this,"price");s(this,"stock");s(this,"createdAt");s(this,"updatedAt");this.type=c.PHONE,this.id=0,this.name=t,this.price=r,this.stock=i,this.createdAt=new Date,this.updatedAt=new Date}}class F{constructor(t,r,i){s(this,"type");s(this,"id");s(this,"name");s(this,"price");s(this,"stock");s(this,"createdAt");s(this,"updatedAt");this.type=c.LAPTOP,this.id=0,this.name=t,this.price=r,this.stock=i,this.createdAt=new Date,this.updatedAt=new Date}}class x{constructor(t,r,i){s(this,"type");s(this,"id");s(this,"name");s(this,"price");s(this,"stock");s(this,"createdAt");s(this,"updatedAt");this.type=c.HEADPHONES,this.id=0,this.name=t,this.price=r,this.stock=i,this.createdAt=new Date,this.updatedAt=new Date}}class B{createPhone(){return new G("iPhone 15",1e3,10)}createLaptop(){return new F("MacBook Pro",2e3,10)}createHeadPhones(){return new x("AirPods Pro",250,10)}}class X{constructor(t,r,i){s(this,"type");s(this,"id");s(this,"name");s(this,"price");s(this,"stock");s(this,"createdAt");s(this,"updatedAt");this.type=c.PHONE,this.id=0,this.name=t,this.price=r,this.stock=i,this.createdAt=new Date,this.updatedAt=new Date}}class T{constructor(t,r,i){s(this,"type");s(this,"id");s(this,"name");s(this,"price");s(this,"stock");s(this,"createdAt");s(this,"updatedAt");this.type=c.LAPTOP,this.id=0,this.name=t,this.price=r,this.stock=i,this.createdAt=new Date,this.updatedAt=new Date}}class ${constructor(t,r,i){s(this,"type");s(this,"id");s(this,"name");s(this,"price");s(this,"stock");s(this,"createdAt");s(this,"updatedAt");this.type=c.HEADPHONES,this.id=0,this.name=t,this.price=r,this.stock=i,this.createdAt=new Date,this.updatedAt=new Date}}class V{createPhone(){return new X("Galaxy S20",1e3,10)}createLaptop(){return new T("Galaxy Book",2100,10)}createHeadPhones(){return new $("Galaxy Buds",250,10)}}class Y{constructor(t,r,i){s(this,"type");s(this,"id");s(this,"name");s(this,"price");s(this,"stock");s(this,"createdAt");s(this,"updatedAt");this.type=c.PHONE,this.id=0,this.name=t,this.price=r,this.stock=i,this.createdAt=new Date,this.updatedAt=new Date}}class U{constructor(t,r,i){s(this,"type");s(this,"id");s(this,"name");s(this,"price");s(this,"stock");s(this,"createdAt");s(this,"updatedAt");this.type=c.LAPTOP,this.id=0,this.name=t,this.price=r,this.stock=i,this.createdAt=new Date,this.updatedAt=new Date}}class b{constructor(t,r,i){s(this,"type");s(this,"id");s(this,"name");s(this,"price");s(this,"stock");s(this,"createdAt");s(this,"updatedAt");this.type=c.HEADPHONES,this.id=0,this.name=t,this.price=r,this.stock=i,this.createdAt=new Date,this.updatedAt=new Date}}class K{createPhone(){return new Y("Mi 13",500,10)}createLaptop(){return new U("Notebook Pro",1500,10)}createHeadPhones(){return new b("AirDots",50,10)}}var A=(e=>(e[e.APPLE=0]="APPLE",e[e.SAMSUNG=1]="SAMSUNG",e[e.XIAOMI=2]="XIAOMI",e))(A||{});class w{static makeFactory(t){switch(t){case 0:return new B;case 1:return new V;case 2:return new K}}}const p=class p{constructor(){s(this,"idCounter");s(this,"items");this.idCounter=0,this.items=[]}static getInstance(){return this.instance==null&&(this.instance=new p),this.instance}incrementIdCounter(){this.idCounter++}getAll(){return this.items}getById(t){return this.items.find(r=>r.id==t)??null}create(t){return this.incrementIdCounter(),t.id=this.idCounter,this.items.push(t),t}update(t,r){let i=this.items.find(a=>a.id==t);if(i)i.name=r.name,i.price=r.price,i.stock=r.stock,i.type=r.type,i.updatedAt=new Date;else return null;return i}delete(t){this.items=this.items.filter(r=>r.id!=t)}};s(p,"instance",null);let D=p;class Q{static getTotalCost(t){let r=0;for(let i of t.products)r+=i.price;return r+=t.deliveryCost,r}}class W{constructor(t){s(this,"cardData");this.cardData=t}processPayment(t){const r=Q.getTotalCost(t);return console.log(`Processing card payment for order: ${t.id}`),console.log(`Total cost: ${r}`),console.log(`Card number: ${this.cardData.cardNumber}`),console.log(`CVV: ${this.cardData.cvv}`),console.log(`Expiration month: ${this.cardData.expirationMonth}`),console.log(`Expiration year: ${this.cardData.expirationYear}`),console.log(`First name: ${this.cardData.firstName}`),console.log(`Last name: ${this.cardData.lastName}`),console.log("Payment successful!"),!0}}class q{deliver(t){var a;let r=0,i=new Date;return(a=t.deliveryAddress)!=null&&a.toLowerCase().includes("moscow")?(r=10,i=new Date(t.createdAt.getFullYear(),t.createdAt.getMonth(),t.createdAt.getDate()+1)):(r=50,i=new Date(t.createdAt.getFullYear(),t.createdAt.getMonth(),t.createdAt.getDate()+4)),{cost:r,date:i}}}const z=new M,S=u.getInstance(),o=D.getInstance(),E=w.makeFactory(A.APPLE),g=w.makeFactory(A.SAMSUNG),f=w.makeFactory(A.XIAOMI),h=new k;o.create(E.createPhone());o.create(E.createLaptop());o.create(E.createHeadPhones());o.create(g.createPhone());o.create(g.createLaptop());o.create(g.createHeadPhones());o.create(f.createPhone());o.create(f.createLaptop());o.create(f.createHeadPhones());const y=[];let d=o.getById(1);d&&y.push(d);d=o.getById(2);d&&y.push(d);d=o.getById(5);d&&y.push(d);h.withProducts(y);h.withPaymentMethod(L.CARD);h.withDeliveryAddress("Russia, Moscow, Snezhnaya, 16");h.withDeliveryMethod(N.EXPRESS);const P=h.build();S.create(P);console.log("Created order: "+P.id);console.log("Order information: ",P);console.log("");const j=new W({cardNumber:"1234567890123456",cvv:"123",expirationMonth:"12",expirationYear:"2028",firstName:"Andrey",lastName:"Pochitaev"}),J=new q,Z=z.processOrder(P,j,J);console.log(Z?"Order was processed":"Order was not processed");const _=S.getAll();console.log("");console.log("All orders: ");for(const e of _)console.log(e);
