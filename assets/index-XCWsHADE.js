var N=Object.defineProperty;var O=(r,t,s)=>t in r?N(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var e=(r,t,s)=>(O(r,typeof t!="symbol"?t+"":t,s),s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const P of n.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&a(P)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();var S=(r=>(r[r.STANDART=1]="STANDART",r[r.EXPRESS=2]="EXPRESS",r[r.PICKUP=3]="PICKUP",r))(S||{}),I=(r=>(r[r.PENDING=1]="PENDING",r[r.DELIVERING=2]="DELIVERING",r[r.DELIVERED=3]="DELIVERED",r))(I||{}),C=(r=>(r[r.CARD=1]="CARD",r[r.PAYPAL=2]="PAYPAL",r[r.QIWI=3]="QIWI",r))(C||{});class L{constructor(){this.id=0,this.createdAt=new Date,this.updatedAt=new Date,this.products=[],this.status=1,this.paymentMethod=null,this.deliveryAddress=null,this.deliveryMethod=null,this.deliveryCost=0,this.paymentStatus=null,this.deliveryStatus=null,this.deliveryDate=null}}class H{constructor(){e(this,"order");this.order=new L}withProducts(t){return this.order.products=t,this}withStatus(t){return this.order.status=t,this}withPaymentMethod(t){return this.order.paymentMethod=t,this}withDeliveryAddress(t){return this.order.deliveryAddress=t,this}withDeliveryMethod(t){return this.order.deliveryMethod=t,this}withDeliveryCost(t){return this.order.deliveryCost=t,this}withPaymentStatus(t){return this.order.paymentStatus=t,this}withDeliveryStatus(t){return this.order.deliveryStatus=t,this}withDeliveryDate(t){return this.order.deliveryDate=t,this}build(){return this.order}}const l=class l{constructor(){e(this,"idCounter");e(this,"items");this.idCounter=0,this.items=[]}static getInstance(){return this.instance==null&&(this.instance=new l),this.instance}incrementIdCounter(){this.idCounter++}getAll(){return this.items}getById(t){return this.items.find(s=>s.id==t)??null}create(t){return this.incrementIdCounter(),t.id=this.idCounter,this.items.push(t),t}update(t,s){let a=this.items.find(i=>i.id==t);if(a)a.createdAt=s.createdAt,a.updatedAt=s.updatedAt,a.products=s.products,a.status=s.status,a.paymentMethod=s.paymentMethod,a.deliveryAddress=s.deliveryAddress,a.deliveryMethod=s.deliveryMethod,a.deliveryCost=s.deliveryCost,a.paymentStatus=s.paymentStatus,a.deliveryStatus=s.deliveryStatus,a.deliveryDate=s.deliveryDate;else return null;return a}delete(t){this.items=this.items.filter(s=>s.id!=t)}};e(l,"instance",null);let h=l;class k{constructor(){e(this,"orderRepository");this.orderRepository=h.getInstance()}processOrder(t,s,a){if(s.processPayment(t)){let n=a.deliver(t);return this.orderRepository.update(t.id,{...t,deliveryCost:n.cost,deliveryStatus:I.PENDING,deliveryDate:n.date}),!0}return!1}}var c=(r=>(r[r.PHONE=0]="PHONE",r[r.LAPTOP=1]="LAPTOP",r[r.HEADPHONES=2]="HEADPHONES",r))(c||{});class M{constructor(t,s,a){e(this,"type");e(this,"id");e(this,"name");e(this,"price");e(this,"stock");e(this,"createdAt");e(this,"updatedAt");this.type=c.PHONE,this.id=0,this.name=t,this.price=s,this.stock=a,this.createdAt=new Date,this.updatedAt=new Date}}class R{constructor(t,s,a){e(this,"type");e(this,"id");e(this,"name");e(this,"price");e(this,"stock");e(this,"createdAt");e(this,"updatedAt");this.type=c.LAPTOP,this.id=0,this.name=t,this.price=s,this.stock=a,this.createdAt=new Date,this.updatedAt=new Date}}class F{constructor(t,s,a){e(this,"type");e(this,"id");e(this,"name");e(this,"price");e(this,"stock");e(this,"createdAt");e(this,"updatedAt");this.type=c.HEADPHONES,this.id=0,this.name=t,this.price=s,this.stock=a,this.createdAt=new Date,this.updatedAt=new Date}}class x{createPhone(){return new M("iPhone 15",1e3,10)}createLaptop(){return new R("MacBook Pro",2e3,10)}createHeadPhones(){return new F("AirPods Pro",250,10)}}class G{constructor(t,s,a){e(this,"type");e(this,"id");e(this,"name");e(this,"price");e(this,"stock");e(this,"createdAt");e(this,"updatedAt");this.type=c.PHONE,this.id=0,this.name=t,this.price=s,this.stock=a,this.createdAt=new Date,this.updatedAt=new Date}}class B{constructor(t,s,a){e(this,"type");e(this,"id");e(this,"name");e(this,"price");e(this,"stock");e(this,"createdAt");e(this,"updatedAt");this.type=c.LAPTOP,this.id=0,this.name=t,this.price=s,this.stock=a,this.createdAt=new Date,this.updatedAt=new Date}}class X{constructor(t,s,a){e(this,"type");e(this,"id");e(this,"name");e(this,"price");e(this,"stock");e(this,"createdAt");e(this,"updatedAt");this.type=c.HEADPHONES,this.id=0,this.name=t,this.price=s,this.stock=a,this.createdAt=new Date,this.updatedAt=new Date}}class ${createPhone(){return new G("Galaxy S20",1e3,10)}createLaptop(){return new B("Galaxy Book",2100,10)}createHeadPhones(){return new X("Galaxy Buds",250,10)}}class T{constructor(t,s,a){e(this,"type");e(this,"id");e(this,"name");e(this,"price");e(this,"stock");e(this,"createdAt");e(this,"updatedAt");this.type=c.PHONE,this.id=0,this.name=t,this.price=s,this.stock=a,this.createdAt=new Date,this.updatedAt=new Date}}class V{constructor(t,s,a){e(this,"type");e(this,"id");e(this,"name");e(this,"price");e(this,"stock");e(this,"createdAt");e(this,"updatedAt");this.type=c.LAPTOP,this.id=0,this.name=t,this.price=s,this.stock=a,this.createdAt=new Date,this.updatedAt=new Date}}class Y{constructor(t,s,a){e(this,"type");e(this,"id");e(this,"name");e(this,"price");e(this,"stock");e(this,"createdAt");e(this,"updatedAt");this.type=c.HEADPHONES,this.id=0,this.name=t,this.price=s,this.stock=a,this.createdAt=new Date,this.updatedAt=new Date}}class U{createPhone(){return new T("Mi 13",500,10)}createLaptop(){return new V("Notebook Pro",1500,10)}createHeadPhones(){return new Y("AirDots",50,10)}}var A=(r=>(r[r.APPLE=0]="APPLE",r[r.SAMSUNG=1]="SAMSUNG",r[r.XIAOMI=2]="XIAOMI",r))(A||{});class D{static makeFactory(t){switch(t){case 0:return new x;case 1:return new $;case 2:return new U}}}const p=class p{constructor(){e(this,"idCounter");e(this,"items");this.idCounter=0,this.items=[]}static getInstance(){return this.instance==null&&(this.instance=new p),this.instance}incrementIdCounter(){this.idCounter++}getAll(){return this.items}getById(t){return this.items.find(s=>s.id==t)??null}create(t){return this.incrementIdCounter(),t.id=this.idCounter,this.items.push(t),t}update(t,s){let a=this.items.find(i=>i.id==t);if(a)a.name=s.name,a.price=s.price,a.stock=s.stock,a.type=s.type,a.updatedAt=new Date;else return null;return a}delete(t){this.items=this.items.filter(s=>s.id!=t)}};e(p,"instance",null);let w=p;class b{static getTotalCost(t){let s=0;for(let a of t.products)s+=a.price;return s+=t.deliveryCost,s}}class K{constructor(t){e(this,"cardData");this.cardData=t}processPayment(t){const s=b.getTotalCost(t);return console.log(`Processing card payment for order: ${t.id}`),console.log(`Total cost: ${s}`),console.log(`Card number: ${this.cardData.cardNumber}`),console.log(`CVV: ${this.cardData.cvv}`),console.log(`Expiration month: ${this.cardData.expirationMonth}`),console.log(`Expiration year: ${this.cardData.expirationYear}`),console.log(`First name: ${this.cardData.firstName}`),console.log(`Last name: ${this.cardData.lastName}`),console.log("Payment successful!"),!0}}class Q{deliver(t){var i;let s=0,a=new Date;return(i=t.deliveryAddress)!=null&&i.toLowerCase().includes("moscow")?(s=10,a=new Date(t.createdAt.getFullYear(),t.createdAt.getMonth(),t.createdAt.getDate()+1)):(s=50,a=new Date(t.createdAt.getFullYear(),t.createdAt.getMonth(),t.createdAt.getDate()+4)),{cost:s,date:a}}}const W=new k,v=h.getInstance(),o=w.getInstance(),g=D.makeFactory(A.APPLE),f=D.makeFactory(A.SAMSUNG),E=D.makeFactory(A.XIAOMI),u=new H;o.create(g.createPhone());o.create(g.createLaptop());o.create(g.createHeadPhones());o.create(f.createPhone());o.create(f.createLaptop());o.create(f.createHeadPhones());o.create(E.createPhone());o.create(E.createLaptop());o.create(E.createHeadPhones());const y=[];let d=o.getById(1);d&&y.push(d);d=o.getById(2);d&&y.push(d);d=o.getById(5);d&&y.push(d);u.withProducts(y);u.withPaymentMethod(C.CARD);u.withDeliveryAddress("Russia, Moscow, Snezhnaya, 16");u.withDeliveryMethod(S.EXPRESS);const m=u.build();v.create(m);console.log("Created order: "+m.id);console.log("Order information: ",m);console.log("");const q=new K({cardNumber:"1234567890123456",cvv:"123",expirationMonth:"12",expirationYear:"2028",firstName:"Andrey",lastName:"Pochitaev"}),z=new Q,j=W.processOrder(m,q,z);console.log(j?"Order was processed":"Order was not processed");const J=v.getAll();console.log("");console.log("All orders: ");for(const r of J)console.log(r);
